<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <p:dialog id="visitante"
              widgetVar="wlvVisitante" 
              modal="true" 
              class="mr1024_60 mr500_90"
              closeOnEscape="true"
              responsive="true"
              resizable="false" 
              fitViewport="true"
              appendTo="@(body)" 
              position="center top">
        <c:if test="#{sstEmpresaVisitantePublicoBean.selected == null}">
            <f:facet name="header">
                NUEVO REGISTRO
            </f:facet>
        </c:if>
        <c:if test="#{sstEmpresaVisitantePublicoBean.selected != null}">
            <f:facet name="header">
                EDITAR DATOS
            </f:facet>
        </c:if>
        <h:form id="frmEmpresaVisitante">
            <f:passThroughAttribute name="autocomplete" value="off"/>
            <div class="ui-fluid" jsf:id="pGridDatos">
                <div class="ui-g">
                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                        <p:fieldset legend="Visitante">
                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Tipo Documento" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:selectOneMenu  
                                        style="width: 99.999%"
                                        required="true"
                                        value="#{sstEmpresaVisitantePublicoBean.i_tipoDocumento}"
                                        requiredMessage="Debe seleccionar un tipo de documento">
                                        <f:selectItem itemLabel="Seleccione uno" itemValue="#{null}" />
                                        <f:selectItems 
                                            var="tipoDoc"
                                            value="#{sstEmpresaVisitantePublicoBean.lstTiposIdentificacion}"
                                            itemLabel="#{tipoDoc.nombre}"
                                            itemValue="#{tipoDoc.idSstTipoIdentificacion}"
                                            />
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Número Documento" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputText 
                                        required="true"
                                        requiredMessage="Debe ingresar número de documento"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.numeroDocumento}" 
                                        />
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Nombre" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputText 
                                        required="true"
                                        requiredMessage="Debe ingresar nombre del visitante"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.nombre}" 
                                        />
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Apellidos" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputText 
                                        required="true"
                                        requiredMessage="Debe ingresar apellidos del visitante"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.apellidos}" 
                                        />
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Tipo de sangre" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:selectOneMenu 
                                        style="width: 99.999%"
                                        filter="true"
                                        required="true"
                                        requiredMessage="Debe seleccionar un tipo de sangre"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.tipoSangre}">
                                        <f:selectItem itemLabel="Seleccione uno" itemValue="#{null}" />
                                        <f:selectItem itemLabel="A+" itemValue="A+" />
                                        <f:selectItem itemLabel="B+" itemValue="B+" />
                                        <f:selectItem itemLabel="O+" itemValue="O+" />
                                        <f:selectItem itemLabel="AB+" itemValue="AB+" />
                                        <f:selectItem itemLabel="A-" itemValue="A-" />
                                        <f:selectItem itemLabel="B-" itemValue="B-" />
                                        <f:selectItem itemLabel="O-" itemValue="O-" />
                                        <f:selectItem itemLabel="AB-" itemValue="AB-" />
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="EPS" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:selectOneMenu  
                                        style="width: 99.999%"
                                        filter="true"
                                        required="true"
                                        requiredMessage="Debe seleccionar una EPS"
                                        value="#{sstEmpresaVisitantePublicoBean.i_sstEps}">
                                        <f:selectItem itemLabel="Seleccione uno" itemValue="#{null}" />
                                        <f:selectItems 
                                            var="eps"
                                            value="#{sstEmpresaVisitantePublicoBean.lstSstEps}"
                                            itemLabel="#{eps.nombre}"
                                            itemValue="#{eps.idSstEps}"
                                            />
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Nivel riesgo ARL" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputText 
                                        required="true"
                                        requiredMessage="Debe ingresar nivel riesgo ARL"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.nivelRiesgoArl}" 
                                        />
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:outputLabel value="Supervisor" for="@next"/>
                                    </div>
                                    <p:selectBooleanButton value="#{sstEmpresaVisitantePublicoBean.b_supervisor}" 
                                                           onLabel="Sí" offLabel="No" 
                                                           onIcon="fa fa-check" 
                                                           offIcon="fa fa-times"
                                                           styleClass="cssWhite">
                                        <p:ajax process="@this" />
                                    </p:selectBooleanButton>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-12 ui-lg-12 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Tipo Labor" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:selectOneMenu 
                                        id="tipo_labor"
                                        style="width: 99.999%"
                                        filter="true"
                                        required="true"
                                        requiredMessage="Debe seleccionar un tipo de labor"
                                        value="#{sstEmpresaVisitantePublicoBean.i_sstTipoLabor}">
                                        <f:selectItem itemDisabled="true"
                                                      itemLabel="Seleccione uno" 
                                                      itemValue="#{null}" />
                                        <f:selectItems 
                                            var="labor"
                                            value="#{sstEmpresaVisitantePublicoBean.lstSstTipoLabores}"
                                            itemLabel="#{labor.tipoLabor}"
                                            itemValue="#{labor.idSstTipoLabor}"
                                            />
                                        <p:ajax event="change" 
                                                process="@this"
                                                global="false"
                                                update="docsVisitante,:msgs"
                                                listener="#{sstEmpresaVisitantePublicoBean.cargarDocumentosPorTipoLabor()}"/>
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="EmptyBox10"></div>
                            <p:fieldset legend="Vehículo">
                                <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:outputLabel value="Tipo Vehiculo" for="@next"/>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:selectOneMenu  
                                            style="width: 99.999%"
                                            value="#{sstEmpresaVisitantePublicoBean.i_sstVehiculoTipo}">
                                            <f:selectItem itemLabel="Seleccione uno" itemValue="#{null}" />
                                            <f:selectItems 
                                                var="tipoVehiculo"
                                                value="#{sstEmpresaVisitantePublicoBean.lstVehiculoTipos}"
                                                itemLabel="#{tipoVehiculo.tipo}"
                                                itemValue="#{tipoVehiculo.idSstVehiculoTipo}"
                                                />
                                        </p:selectOneMenu>
                                    </div>
                                </div>

                                <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:outputLabel value="Placa" for="@next"/>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:inputText 
                                            value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.placaVehiculo}" 
                                            />
                                    </div>
                                </div>

                                <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:outputLabel value="Marca Vehiculo" for="@next"/>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:selectOneMenu  
                                            style="width: 99.999%"
                                            value="#{sstEmpresaVisitantePublicoBean.i_sstVehiculoMarca}">
                                            <f:selectItem itemLabel="Seleccione uno" itemValue="#{null}" />
                                            <f:selectItems 
                                                var="marcaVehiculo"
                                                value="#{sstEmpresaVisitantePublicoBean.lstVehiculoMarcas}"
                                                itemLabel="#{marcaVehiculo.marca}"
                                                itemValue="#{marcaVehiculo.idSstVehiculoMarca}"
                                                />
                                        </p:selectOneMenu>
                                    </div>
                                </div>

                                <div class="ui-g-12 ui-md-3 ui-lg-3 Padding5">
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:outputLabel value="Color" for="@next"/>
                                    </div>
                                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                        <p:inputText 
                                            value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.colorVehiculo}" 
                                            />
                                    </div>
                                </div>
                            </p:fieldset>
                        </p:fieldset>
                    </div>
                    <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                        <p:fieldset legend="Contacto de emergencia">
                            <div class="ui-g-12 ui-md-4 ui-lg-4 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Nombre completo" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputText 
                                        required="true"
                                        requiredMessage="Debe ingresar nombre completo del contacto"
                                        value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.nombreContactoEmergencia}" 
                                        />
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-4 ui-lg-4 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Teléfono fijo" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputMask required="true"
                                                 requiredMessage="Debe ingresar teléfono fijo del contacto"
                                                 validatorMessage="Debe ingresar un teléfono fijo válido"
                                                 value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.telefonoFijoContactoEmergencia}"  
                                                 mask="9999999"/>
                                </div>
                            </div>

                            <div class="ui-g-12 ui-md-4 ui-lg-4 Padding5">
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:outputLabel value="Teléfono móvil" for="@next"/>
                                </div>
                                <div class="ui-g-12 ui-md-12 ui-lg-12 Padding0">
                                    <p:inputMask required="true"
                                                 validatorMessage="Debe ingresar un teléfono móvil válido"
                                                 requiredMessage="Debe ingresar teléfono móvil del contacto"
                                                 value="#{sstEmpresaVisitantePublicoBean.sstEmpresaVisitante.telefonoMovilContactoEmergencia}" 
                                                 mask="9999999999">
                                    </p:inputMask>
                                </div>
                            </div>
                        </p:fieldset>
                    </div>
                </div>
                <div class="EmptyBox10"></div>
                <div class="ui-g">
                    <div class="ui-g-12 ui-md-12 ui-lg-12" jsf:id="docsVisitante">
                        <p:fieldset legend="Documentos visitante" rendered="#{sstEmpresaVisitantePublicoBean.mostrarListaDocumentos()}">
                            <p:dataTable id="dtDocumentos" 
                                         rowIndexVar="index"
                                         var="documento" 
                                         scrollable="true"
                                         widgetVar="dtDocumento"
                                         scrollHeight="600"
                                         disabledTextSelection="false"
                                         reflow="true"
                                         rows="10"
                                         filterDelay="1700"
                                         paginator="true"
                                         currentPageReportTemplate="Mostrando {endRecord} de {totalRecords} registros"
                                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rowsPerPageTemplate="10,50,100"
                                         emptyMessage="No existen registros"
                                         value="#{sstEmpresaVisitantePublicoBean.lstDocumentosArchivos}">

                                <p:column headerText="Nombre"
                                          style="text-align: center;">
                                    <h:outputText value="#{documento.empresaVisitanteDoc.idSstDocumentoTercero.tipoDocTercero}"/>
                                </p:column>
                                <p:column headerText="Número"
                                          style="text-align: center;">
                                    <h:outputText 
                                        value="#{documento.empresaVisitanteDoc.numero}"
                                        rendered="#{documento.empresaVisitanteDoc.numero != null}"/>
                                    <h:outputText value="N/A" rendered="#{documento.empresaVisitanteDoc.numero == null}"/>
                                </p:column>
                                <p:column headerText="Desde"
                                          style="text-align: center;">
                                    <h:outputText 
                                        value="#{documento.empresaVisitanteDoc.desde}"
                                        rendered="#{documento.empresaVisitanteDoc.desde != null}">
                                        <f:convertDateTime type="date" pattern="YYYY-MM-dd"/>
                                    </h:outputText>
                                    <h:outputText value="N/A" rendered="#{documento.empresaVisitanteDoc.desde == null}"/>
                                </p:column>
                                <p:column headerText="Hasta"
                                          style="text-align: center;">
                                    <h:outputText 
                                        value="#{documento.empresaVisitanteDoc.hasta}"
                                        rendered="#{documento.empresaVisitanteDoc.hasta != null}">
                                        <f:convertDateTime type="date" pattern="YYYY-MM-dd"/>
                                    </h:outputText>
                                    <h:outputText value="N/A" rendered="#{documento.empresaVisitanteDoc.hasta == null}"/>
                                </p:column>
                                <p:column style="text-align: center;" styleClass="text-word-wrap">
                                    <f:facet name="header">
                                        <h:outputText value="Descripción"/>
                                    </f:facet>
                                    <h:outputText value="#{documento.empresaVisitanteDoc.idSstDocumentoTercero.descripcion}"/>
                                </p:column>

                                <p:column style="text-align: center;"
                                          width="10%"
                                          styleClass="#{documento.empresaVisitanteDoc.idSstDocumentoTercero.requerido == 1 ? 'cssGreen texto-blanco' : documento.empresaVisitanteDoc.idSstDocumentoTercero.requerido == 0 ? 'cssRed texto-blanco' : null}">
                                    <f:facet name="header">
                                        <h:outputText value="Requerido"/>
                                    </f:facet>
                                    <h:outputText value="Si" style="color: white; font-weight: bolder" rendered="#{documento.empresaVisitanteDoc.idSstDocumentoTercero.requerido == 1}"/>
                                    <h:outputText value="No" style="color: white; font-weight: bolder" rendered="#{documento.empresaVisitanteDoc.idSstDocumentoTercero.requerido == 0}"/>
                                </p:column>

                                <p:column headerText="Agregar documento" style="text-align: center;"
                                          width="10%"
                                          exportable="false">
                                    <div class="ui-g Padding0">
                                        <div class="ui-g-6 ui-md-6 ui-lg-6">
                                            <p:commandButton styleClass="cssWhite GreenButton"
                                                             title="Agregar"
                                                             process="@this"
                                                             update=":frmAddFiles,:frmDatosEmpresa"
                                                             oncomplete="PF('AddFilesListDialog').show();"
                                                             icon="fa fa-plus">
                                                <p:resetInput target=":frmDatosEmpresa:pGridDatos"/>
                                                <f:setPropertyActionListener value="#{index}" target="#{sstEmpresaVisitantePublicoBean.i_ArchivoIndex}"/>
                                                <f:setPropertyActionListener value="#{documento.empresaVisitanteDoc}" target="#{sstEmpresaVisitantePublicoBean.sstVisitanteDocs}"/>
                                            </p:commandButton>
                                        </div>
                                        <div class="ui-g-6 ui-md-6 ui-lg-6">
                                            <p:commandButton styleClass="cssWhite RedButton"
                                                             title="Cancelar Subida"
                                                             process="@this"
                                                             disabled="#{documento.file == null}"
                                                             actionListener="#{sstEmpresaVisitantePublicoBean.cancelarArchivo(index)}"
                                                             update="dtDocumentos,:msgs"
                                                             icon="fa fa-times">
                                            </p:commandButton>
                                        </div>
                                    </div>
                                </p:column>

                                <p:column style="text-align: center;"
                                          width="10%">
                                    <f:facet name="header">
                                        <h:outputText value="Subido" />
                                    </f:facet>
                                    <i class="fa fa-check GreenButton" jsf:rendered="#{documento.file != null}"></i>
                                </p:column>
                            </p:dataTable>
                        </p:fieldset>
                    </div>
                </div>
            </div>
            <p:remoteCommand name="guardar" 
                             update=":msgs,pGridDatos,:frmPrincipal:dtVisitantes" 
                             action="#{sstEmpresaVisitantePublicoBean.guardar()}"/>
            <p:remoteCommand name="actualizar"
                             update=":msgs,:frmPrincipal:dtVisitantes"
                             action="#{sstEmpresaVisitantePublicoBean.guardar()}"/>
        </h:form>
        <f:facet name="footer">
            <div align="center">
                <p:commandButton value="Guardar" icon="fa fa-floppy-o"
                                 rendered="#{sstEmpresaVisitantePublicoBean.selected == null}"
                                 class="cssWhite" onclick="guardar()"/>
                <p:commandButton value="Actualizar" icon="fa fa-floppy-o"
                                 rendered="#{sstEmpresaVisitantePublicoBean.selected != null}"
                                 class="cssWhite" onclick="actualizar()"/>
            </div>
        </f:facet>
    </p:dialog>
    <ui:include src="modal/AddFiles.xhtml"/>
</ui:composition>     